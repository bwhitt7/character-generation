# Toyhouse Nunjucks Character Profile Generator

## Who should use this?
This tool fills a very specific niche. If you use toyhouse, have a ton of characters that use the same html template, and have decent experience with node, json, and/or some sort of templating language, this is for you.

## Why should you use this?
If you've tried updating the code for multiple characters (such as adding a new section, using an updated version of a template, or using a new template entirely), it can be a very tedious process. This tool allows you to store character locally data and quickly generate html code from a template file.

## How to Run
1. Make sure [node](https://nodejs.org) is installed on your system.
2. Clone this GitHub project onto your machine. There are some ways of doing this.
    1. Downloading the zip of the project.
    2. Installing [git](https://git-scm.com/) onto your machine and running `git clone [url]` in the directory where you want the project downloaded to.
3. Open a terminal in the folder.
4. Run `npm install` to install all the needed node modules.
5. Run `node generation.js`! You should see a list of example folders. Enter the number of the folder you want to generate. If there are no errors and you see an "out" folder in the folder you picked with an .html file, it worked!

## Layout explaination
The `template` folder is where we store everything needed to generate our character bios. The tool is built to allow for multiple templates to be used. The intended file organization is:

<pre>
.
├── templates
│   └── groupDirectory1
│       ├── in
│       │   └── character1.json
│       ├── out
│       │   └── character1.html
│       └── template.njk
│
├── generation.js
└── README.md
</pre>

Group Directories are intended to represent group of characters that share the same template html. If all of your characters use the same template, then you can put them all in the same group directory if you so choose.

Inside of a group directory is an `/in` directory, an `/out` directory (optional, this will be automatically generated by the code), and the `template.njk` Nunjucks template.

The `/in` directory is where all of your character json data will be stored. You can honestly do whatever you want when it comes to the json files, but all characters in the same group directory should have the same layout of data.

The `/out` directory is where your generated html character profiles will be stored. To use them, copy and paste the contents of the files into the html section on your character. I recommend testing out everything generated properly by first previewing the code on https://th.circlejourney.net/. 

And finally `template.njk` is where the magic happens. If you are unfamiliar with Nunjucks or similar templating languages, this is where the steepest learning curve will be. I've included some basic examples for the use cases you will likely run into, but I definitely recommend looking at the [Nunjucks documentation](https://mozilla.github.io/nunjucks/templating.html) and following some tutorials/guides. However you will likely just need to know the very basics of Nunjucks, such as how to use `if`, `for` and `set`, and do basic variable insertion.

## How to create a group directory
1. In the `templates` directory, add a folder and name it whatever you want.
2. Inside this directory, add a subfolder called `in`.
3. Finally, add a `template.njk` file.

## How to create characters in a group directory
1. In the `in` folder of the group directory, add a json file named whatever you want, such as `exampleCharacter.json`.
2. In this file, put whatever information you want to be usable in the `template.njk` file.

Let's look at an example.
<pre>
{
    "name": "Character Name",
    "basic_info": {
        "pronouns": "they/them",
        "age": 999
    },
    "traits": [
        "trait 1",
        "trait 2",
        "trait 3"
    ]
}
</pre>
I recommend getting yourself aquainted with JSON formatting and variable types.

The variables useable from this character json file are:
- `char.name`
- `char.basic_info.pronouns`
- `char.basic_info.age`
- `char.traits` (returns a list, which can then accessed in a for loop, or through index, such as `char.traits[0]`)

## How to create a template
I recommend working with a premade template (either one you made yourself, or one someone else made. Look at the !!IMPORTANT!! notice below if you're using someone else's template). I normally fill out a template normally with a character, so I know what information I need to include in the JSON file and Nunjucks template.

Copy the html template into the `template.njk` file. Start slowly creating a json file with your character information, and then replacing where the information should go in the template with Nunjucks variables. This is honestly a fairly slow process, especially with larger codes.

As you go, I recommend testing the code you're creating. There are two methods I tend to go with.
1. Do everything through the code, and run the generation script periodically as you go. Make sure there are no errors (if there are, check the error messages. It's likely you forgot to close a for loop or if statement somewhere). Copy and paste the html file generated into https://th.circlejourney.net/ or a testing character on toyhouse to see how everything looks. 
    - Pros: Makes sure everything works within the script.
    - Cons: Can be a slow process due to needing to constantly copy and paste into a testing site.
2. Do everything on a Nunjucks testing site. I recommend https://diosmaden.art/toyhouse/nunjucks/ since it's configured to toyhouse's CSS and all that. To do this, copy and paste the template into the text field. To include the character json data, ABOVE the template, copy and paste the json data into a Nunjuck variable called `char`.
    - Pros: Much faster, real-time updates on changes made to code.
    - Cons: You will need to copy and paste the code back into the tool, and make sure to separate out the character json data back into its own file.


## !!IMPORTANT!!
If you intend on using a premade template made by someone else, make sure to follow their TOS! If they state you cannot edit their code, do not use their template with this, since you will need to heavily edit the code to make it properly work. And of course, ensure their credits are still in the code after modifying it.


## Extras
- Currently, this code has just been tested on Windows. I'm unsure about its compatibility with macOS or Linux due to path differences.
- All json files in a group directory that starts with `!` will be loaded during generation. You can access these files with `{% set <name_of_variable> = load.<name_of_file_without_.json> %}`. This is useful for storing data that you intend to reuse on multiple characters.
    - I personally use this to store links for each character to be used in relationship sections of bios.
- Run `node generation.js <name_of_group_directory>` to directly generate files in that group directory without needing to go through the numbered folder menu.
- I normally create some sort of `placeholder.json` file in a group directory that contains all the JSON fields I need for each character. If you keep this out of the `in` directory, it shouldn't be used in generation.
- Don't like Nunjucks and want to use a different templating language? This tool should be flexible enough to allow that! A majority of the code is just file management stuff, so it should be simple enough to replace the `nunjucks.configure` and `nunjucks.render` with whatever you need to render a different templating language instead.

## Usage Rules
This is public code that can be used for whatever, repurposed for other things, etc. No need to credit me if you use this for your codes, but feel free to link back here if you want to promote this tool!